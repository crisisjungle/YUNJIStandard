<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº‘åŸºåŠ¨ç¯ç›‘æ§ç³»ç»Ÿ - æ¶æ„å›¾</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'PingFang SC', 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 40px 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            font-size: 32px;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .subtitle {
            text-align: center;
            color: #7f8c8d;
            font-size: 16px;
            margin-bottom: 40px;
        }

        .diagram-section {
            margin-bottom: 60px;
        }

        .diagram-title {
            font-size: 24px;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .diagram-container {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 40px;
            margin-bottom: 30px;
            overflow-x: auto;
            min-height: 700px;
        }

        .diagram-description {
            background: #f0f4ff;
            border-left: 4px solid #667eea;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            font-size: 14px;
            color: #52616b;
            line-height: 1.8;
        }

        .mermaid {
            display: flex;
            justify-content: center;
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
        }

        .nav-tab {
            padding: 12px 24px;
            background: #f8f9fa;
            border: none;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            font-size: 15px;
            font-weight: 500;
            color: #7f8c8d;
            transition: all 0.3s;
        }

        .nav-tab:hover {
            background: #e9ecef;
            color: #2c3e50;
        }

        .nav-tab.active {
            background: #667eea;
            color: white;
        }

        .diagram-content {
            display: none;
        }

        .diagram-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>äº‘åŸºåŠ¨ç¯ç›‘æ§ç³»ç»Ÿæ¶æ„å›¾</h1>
        <p class="subtitle">ç³»ç»Ÿä¸Šä¸‹æ–‡å›¾ã€ç”¨ä¾‹å›¾ã€é€»è¾‘æ¶æ„å›¾</p>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showDiagram('context')">1. ä¸Šä¸‹æ–‡å›¾</button>
            <button class="nav-tab" onclick="showDiagram('usecase')">2. ç”¨ä¾‹å›¾</button>
            <button class="nav-tab" onclick="showDiagram('architecture')">3. é€»è¾‘æ¶æ„å›¾</button>
        </div>

        <!-- ä¸Šä¸‹æ–‡å›¾ -->
        <div id="context" class="diagram-content active">
            <div class="diagram-section">
                <h2 class="diagram-title">ğŸ“¡ ç³»ç»Ÿä¸Šä¸‹æ–‡å›¾ (Context Diagram)</h2>
                <div class="diagram-container">
                    <div class="mermaid">
graph TB
    subgraph Top[" "]
        direction LR
        Production["ç”Ÿäº§äººå‘˜<br/>Production Personnel"]
        Installer["å®‰è£…äººå‘˜<br/>Installation Personnel"]
        Customer["å®¢æˆ·äººå‘˜<br/>Customer Personnel"]
        Engineer["å”®åå·¥ç¨‹å¸ˆ<br/>After-sales Engineer"]
    end

    subgraph Middle[" "]
        System["äº‘åŸºåŠ¨ç¯ç›‘æ§ç³»ç»Ÿ<br/>Core System"]
    end

    subgraph Bottom[" "]
        direction LR
        Devices["ç›‘æ§è®¾å¤‡<br/>Monitoring Devices<br/>(UPS/PDU/ç©ºè°ƒ/ç”µæ± ç­‰)"]
        Database["æ•°æ®åº“<br/>Database"]
        FileSystem["æ–‡ä»¶ç³»ç»Ÿ<br/>File System"]
        Network["ç½‘ç»œç³»ç»Ÿ<br/>Network System"]
    end

    Production -->|å·¥ç¨‹é…ç½®<br/>Engineering Config| System
    Production -->|ç­–ç•¥åº“ç®¡ç†<br/>Strategy Library| System
    Production -->|æ¨¡æ¿ç®¡ç†<br/>Template Management| System

    Installer -->|ç°åœºéƒ¨ç½²<br/>On-site Deployment| System
    Installer -->|è®¾å¤‡æ¥å…¥<br/>Device Access| System
    Installer -->|éªŒæ”¶æ£€æµ‹<br/>Acceptance Test| System

    Customer -->|è¿ç»´å·¡æ£€<br/>Operations Inspection| System
    Customer -->|å‘Šè­¦å¤„ç†<br/>Alarm Handling| System
    Customer -->|æ•°æ®æŸ¥è¯¢<br/>Data Query| System
    Customer -->|æŠ¥è¡¨æŸ¥çœ‹<br/>Report Viewing| System

    Engineer -->|ç³»ç»Ÿç»´æŠ¤<br/>System Maintenance| System
    Engineer -->|å‡çº§æ›´æ–°<br/>Upgrade| System
    Engineer -->|æ•…éšœè¯Šæ–­<br/>Fault Diagnosis| System

    System -->|æ•°æ®é‡‡é›†<br/>Data Collection| Devices
    System -->|è®¾å¤‡æ§åˆ¶<br/>Device Control| Devices
    System -->|çŠ¶æ€ç›‘æ§<br/>Status Monitoring| Devices

    System -->|æ•°æ®å­˜å‚¨<br/>Data Storage| Database
    System -->|é…ç½®å­˜å‚¨<br/>Config Storage| Database
    System -->|æ—¥å¿—å­˜å‚¨<br/>Log Storage| Database

    System -->|æ–‡ä»¶è¯»å†™<br/>File I/O| FileSystem
    System -->|ç½‘ç»œé€šä¿¡<br/>Network Communication| Network

    style System fill:#667eea,stroke:#764ba2,stroke-width:4px,color:#fff
    style Production fill:#ffc107,stroke:#ff9800,stroke-width:2px
    style Installer fill:#4ecdc4,stroke:#44a08d,stroke-width:2px
    style Customer fill:#52d291,stroke:#198754,stroke-width:2px
    style Engineer fill:#ff6c6c,stroke:#dc3545,stroke-width:2px
    style Devices fill:#95a5a6,stroke:#7f8c8d,stroke-width:2px
    style Database fill:#9b59b6,stroke:#8e44ad,stroke-width:2px
    style FileSystem fill:#3498db,stroke:#2980b9,stroke-width:2px
    style Network fill:#e67e22,stroke:#d35400,stroke-width:2px
    style Top fill:transparent,stroke:transparent
    style Middle fill:transparent,stroke:transparent
    style Bottom fill:transparent,stroke:transparent
                    </div>
                </div>
                <div class="diagram-description">
                    <strong>è¯´æ˜ï¼š</strong>ç³»ç»Ÿä¸Šä¸‹æ–‡å›¾å±•ç¤ºäº†äº‘åŸºåŠ¨ç¯ç›‘æ§ç³»ç»Ÿä¸å¤–éƒ¨å®ä½“ä¹‹é—´çš„äº¤äº’å…³ç³»ã€‚
                    ç³»ç»Ÿæ ¸å¿ƒä¸ç”Ÿäº§äººå‘˜ã€å®‰è£…äººå‘˜ã€å®¢æˆ·äººå‘˜ã€å”®åå·¥ç¨‹å¸ˆç­‰ç”¨æˆ·è§’è‰²äº¤äº’ï¼ŒåŒæ—¶ä¸ç›‘æ§è®¾å¤‡ã€æ•°æ®åº“ã€æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œç³»ç»Ÿç­‰å¤–éƒ¨ç³»ç»Ÿè¿›è¡Œæ•°æ®äº¤æ¢ã€‚
                </div>
            </div>
        </div>

        <!-- ç”¨ä¾‹å›¾ -->
        <div id="usecase" class="diagram-content">
            <div class="diagram-section">
                <h2 class="diagram-title">ğŸ‘¥ ç”¨ä¾‹å›¾ (Use Case Diagram)</h2>
                <div class="diagram-container">
                    <div class="mermaid" id="usecaseDiagram">
graph LR
    subgraph P1["ç”Ÿäº§äººå‘˜"]
        direction TB
        UC1[å·¥ç¨‹æ¨¡æ¿é…ç½®]
        UC2[æœºæŸœä¿¡æ¯å½•å…¥]
        UC3[è®¾å¤‡é…ç½®ç®¡ç†]
        UC4[è”åŠ¨ç­–ç•¥é…ç½®]
        UC5[å‘Šè­¦è§„åˆ™é…ç½®]
        UC6[ç»„æ€æ¨¡æ¿é€‰æ‹©]
        UC1 --> UC2
        UC1 --> UC3
        UC1 --> UC4
        UC1 --> UC5
        UC1 --> UC6
    end

    subgraph P2["å®‰è£…äººå‘˜"]
        direction TB
        UC7[ç³»ç»Ÿè°ƒè¯•è‡ªæ£€]
        UC8[éªŒæ”¶æŠ¥å‘Šç”Ÿæˆ]
        UC7 --> UC8
    end

    subgraph P3["å®¢æˆ·äººå‘˜"]
        direction TB
        UC9[å®æ—¶ç›‘æ§]
        UC10[å‘Šè­¦ç®¡ç†]
        UC11[æ•°æ®æŸ¥è¯¢]
        UC12[æŠ¥è¡¨åˆ†æ]
        UC13[è¿ç»´å·¡æ£€]
    end

    subgraph P4["å”®åå·¥ç¨‹å¸ˆ"]
        direction TB
        UC14[ç³»ç»Ÿç»´æŠ¤]
        UC15[ç³»ç»Ÿå‡çº§]
        UC16[æ•…éšœè¯Šæ–­]
    end

    P1 --> P2
    P2 --> P3
    P3 --> P4

    style P1 fill:#fff3cd,stroke:#ffc107,stroke-width:3px
    style P2 fill:#d1ecf1,stroke:#4ecdc4,stroke-width:3px
    style P3 fill:#d4edda,stroke:#52d291,stroke-width:3px
    style P4 fill:#f8d7da,stroke:#ff6c6c,stroke-width:3px
    style UC1 fill:#667eea,stroke:#764ba2,stroke-width:2px,color:#fff
    style UC7 fill:#667eea,stroke:#764ba2,stroke-width:2px,color:#fff
    style UC9 fill:#667eea,stroke:#764ba2,stroke-width:2px,color:#fff
                    </div>
                </div>
                <div class="diagram-description">
                    <strong>è¯´æ˜ï¼š</strong>ç”¨ä¾‹å›¾å±•ç¤ºäº†ä¸åŒç”¨æˆ·è§’è‰²ä¸ç³»ç»ŸåŠŸèƒ½ç”¨ä¾‹ä¹‹é—´çš„å…³ç³»ã€‚
                    ç”Ÿäº§äººå‘˜ä¸»è¦è´Ÿè´£å·¥ç¨‹é…ç½®ç›¸å…³ç”¨ä¾‹ï¼Œå®‰è£…äººå‘˜è´Ÿè´£è°ƒè¯•è‡ªæ£€å’ŒéªŒæ”¶ï¼Œå®¢æˆ·äººå‘˜ä½¿ç”¨ç›‘æ§å’Œè¿ç»´åŠŸèƒ½ï¼Œå”®åå·¥ç¨‹å¸ˆè´Ÿè´£ç³»ç»Ÿç»´æŠ¤å’Œæ•…éšœå¤„ç†ã€‚
                </div>
            </div>
        </div>

        <!-- é€»è¾‘æ¶æ„å›¾ -->
        <div id="architecture" class="diagram-content">
            <div class="diagram-section">
                <h2 class="diagram-title">ğŸ—ï¸ é€»è¾‘æ¶æ„å›¾ (Logical Architecture Diagram)</h2>
                <div class="diagram-container">
                    <div class="mermaid" id="architectureDiagram">
graph TB
    subgraph Layer1["è¡¨ç¤ºå±‚ Presentation Layer"]
        UI1[å·¥ç¨‹æ¨¡æ¿é€‰æ‹©ç•Œé¢]
        UI2[è°ƒè¯•è‡ªæ£€ç•Œé¢]
        UI3[åŠ¨ç¯ç›‘æ§å¹³å°]
        UI4[ç§»åŠ¨ç«¯APP]
    end

    subgraph Layer2["ä¸šåŠ¡é€»è¾‘å±‚ Business Logic Layer"]
        BL1[å·¥ç¨‹é…ç½®æœåŠ¡]
        BL2[è®¾å¤‡ç®¡ç†æœåŠ¡]
        BL3[ç­–ç•¥ç®¡ç†æœåŠ¡]
        BL4[å‘Šè­¦ç®¡ç†æœåŠ¡]
        BL5[æ•°æ®é‡‡é›†æœåŠ¡]
        BL6[è”åŠ¨æ§åˆ¶æœåŠ¡]
        BL7[è°ƒè¯•è‡ªæ£€æœåŠ¡]
        BL8[ç›‘æ§å±•ç¤ºæœåŠ¡]
        BL9[æŠ¥è¡¨åˆ†ææœåŠ¡]
        BL10[ç”¨æˆ·æƒé™æœåŠ¡]
    end

    subgraph Layer3["æ•°æ®è®¿é—®å±‚ Data Access Layer"]
        DAL1[è®¾å¤‡æ•°æ®è®¿é—®]
        DAL2[é…ç½®æ•°æ®è®¿é—®]
        DAL3[å†å²æ•°æ®è®¿é—®]
        DAL4[æ—¥å¿—æ•°æ®è®¿é—®]
    end

    subgraph Layer4["æ•°æ®å±‚ Data Layer"]
        DB1[å®æ—¶æ•°æ®åº“]
        DB2[å†å²æ•°æ®åº“]
        DB3[é…ç½®æ•°æ®åº“]
        DB4[æ—¥å¿—æ•°æ®åº“]
    end

    subgraph Layer5["è®¾å¤‡æ¥å£å±‚ Device Interface Layer"]
        DI1[è®¾å¤‡é©±åŠ¨ç®¡ç†]
        DI2[é€šä¿¡åè®®é€‚é…]
        DI3[è®¾å¤‡è¿æ¥ç®¡ç†]
    end

    subgraph Layer6["å¤–éƒ¨ç³»ç»Ÿ External Systems"]
        EXT1[ç›‘æ§è®¾å¤‡]
        EXT2[ç¬¬ä¸‰æ–¹ç³»ç»Ÿ]
    end

    UI1 --> BL1
    UI1 --> BL2
    UI1 --> BL3
    UI2 --> BL7
    UI3 --> BL4
    UI3 --> BL5
    UI3 --> BL8
    UI3 --> BL9
    UI4 --> BL8
    UI4 --> BL4

    BL1 --> DAL2
    BL2 --> DAL1
    BL3 --> DAL2
    BL4 --> DAL1
    BL4 --> DAL4
    BL5 --> DAL1
    BL6 --> DAL1
    BL7 --> DAL1
    BL7 --> DAL4
    BL8 --> DAL1
    BL8 --> DAL3
    BL9 --> DAL3
    BL10 --> DAL2

    DAL1 --> DB1
    DAL2 --> DB3
    DAL3 --> DB2
    DAL4 --> DB4

    BL5 --> DI1
    BL6 --> DI1
    BL2 --> DI1

    DI1 --> DI2
    DI1 --> DI3
    DI2 --> EXT1
    DI3 --> EXT1

    BL4 -.-> EXT2
    BL9 -.-> EXT2

    style Layer1 fill:#e7f1ff,stroke:#667eea,stroke-width:3px
    style Layer2 fill:#d4edda,stroke:#52d291,stroke-width:3px
    style Layer3 fill:#fff3cd,stroke:#ffc107,stroke-width:3px
    style Layer4 fill:#e2d9f3,stroke:#9b59b6,stroke-width:3px
    style Layer5 fill:#d1ecf1,stroke:#4ecdc4,stroke-width:3px
    style Layer6 fill:#f8d7da,stroke:#ff6c6c,stroke-width:3px
    style UI1 fill:#667eea,stroke:#764ba2,stroke-width:2px,color:#fff
    style UI2 fill:#667eea,stroke:#764ba2,stroke-width:2px,color:#fff
    style UI3 fill:#667eea,stroke:#764ba2,stroke-width:2px,color:#fff
                    </div>
                </div>
                <div class="diagram-description">
                    <strong>è¯´æ˜ï¼š</strong>é€»è¾‘æ¶æ„å›¾å±•ç¤ºäº†ç³»ç»Ÿçš„åˆ†å±‚æ¶æ„è®¾è®¡ã€‚
                    <ul style="margin-top: 10px; padding-left: 20px;">
                        <li><strong>è¡¨ç¤ºå±‚ï¼š</strong>åŒ…å«å·¥ç¨‹æ¨¡æ¿é€‰æ‹©ç•Œé¢ã€è°ƒè¯•è‡ªæ£€ç•Œé¢ã€åŠ¨ç¯ç›‘æ§å¹³å°å’Œç§»åŠ¨ç«¯APP</li>
                        <li><strong>ä¸šåŠ¡é€»è¾‘å±‚ï¼š</strong>åŒ…å«å„ç§ä¸šåŠ¡æœåŠ¡ï¼Œå¦‚å·¥ç¨‹é…ç½®ã€è®¾å¤‡ç®¡ç†ã€ç­–ç•¥ç®¡ç†ã€å‘Šè­¦ç®¡ç†ç­‰</li>
                        <li><strong>æ•°æ®è®¿é—®å±‚ï¼š</strong>æä¾›ç»Ÿä¸€çš„æ•°æ®è®¿é—®æ¥å£ï¼Œéš”ç¦»ä¸šåŠ¡é€»è¾‘ä¸æ•°æ®å­˜å‚¨</li>
                        <li><strong>æ•°æ®å±‚ï¼š</strong>åŒ…å«å®æ—¶æ•°æ®åº“ã€å†å²æ•°æ®åº“ã€é…ç½®æ•°æ®åº“å’Œæ—¥å¿—æ•°æ®åº“</li>
                        <li><strong>è®¾å¤‡æ¥å£å±‚ï¼š</strong>è´Ÿè´£è®¾å¤‡é©±åŠ¨ç®¡ç†ã€é€šä¿¡åè®®é€‚é…å’Œè®¾å¤‡è¿æ¥ç®¡ç†</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#667eea',
                primaryTextColor: '#fff',
                primaryBorderColor: '#764ba2',
                lineColor: '#667eea',
                secondaryColor: '#f0f4ff',
                tertiaryColor: '#f8f9fa',
                noteBkgColor: '#fff3cd',
                noteTextColor: '#856404',
                noteBorderColor: '#ffc107',
                actorBorder: '#667eea',
                actorBkg: '#f0f4ff',
                actorTextColor: '#2c3e50',
                actorLineColor: '#667eea',
                signalColor: '#667eea',
                signalTextColor: '#2c3e50',
                labelBoxBkgColor: '#f0f4ff',
                labelBoxBorderColor: '#667eea',
                labelTextColor: '#2c3e50',
                loopTextColor: '#2c3e50',
                activationBorderColor: '#667eea',
                activationBkgColor: '#e7f1ff',
                sequenceNumberColor: '#fff',
                sectionBkgColor: '#f8f9fa',
                altBkgColor: '#f0f4ff',
                critBkgColor: '#fff5f5',
                doneBkgColor: '#d1e7dd',
                doneBorderColor: '#198754'
            },
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis',
                padding: 50,
                nodeSpacing: 80,
                rankSpacing: 120
            }
        });

        function showDiagram(diagramId) {
            // éšè—æ‰€æœ‰å›¾è¡¨
            document.querySelectorAll('.diagram-content').forEach(content => {
                content.classList.remove('active');
            });

            // ç§»é™¤æ‰€æœ‰æ ‡ç­¾çš„activeçŠ¶æ€
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // æ˜¾ç¤ºé€‰ä¸­çš„å›¾è¡¨
            const targetContent = document.getElementById(diagramId);
            targetContent.classList.add('active');
            
            // æ¿€æ´»å¯¹åº”çš„æ ‡ç­¾
            event.target.classList.add('active');

            // é‡æ–°æ¸²æŸ“Mermaidå›¾è¡¨ï¼ˆå¦‚æœéœ€è¦ï¼‰
            setTimeout(() => {
                const mermaidElements = targetContent.querySelectorAll('.mermaid');
                mermaidElements.forEach(element => {
                    // å¦‚æœå›¾è¡¨è¿˜æ²¡æœ‰æ¸²æŸ“ï¼Œå¼ºåˆ¶é‡æ–°åˆå§‹åŒ–
                    if (!element.querySelector('svg')) {
                        const graphDefinition = element.textContent.trim();
                        element.innerHTML = '';
                        element.textContent = graphDefinition;
                        mermaid.init(undefined, [element]);
                    }
                });
            }, 100);
        }
    </script>
</body>
</html>

